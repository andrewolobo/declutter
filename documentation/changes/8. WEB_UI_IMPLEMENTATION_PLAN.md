# DEC_L Web UI Implementation Plan

**Version:** 1.0  
**Date:** December 16, 2025  
**Status:** Planning Phase  
**Technology Stack:** SvelteKit, TypeScript, TailwindCSS

---

## Table of Contents

1. [Overview](#overview)
2. [Technology Stack](#technology-stack)
3. [Project Structure](#project-structure)
4. [Implementation Phases](#implementation-phases)
5. [Configuration Setup](#configuration-setup)
6. [Component Architecture](#component-architecture)
7. [State Management](#state-management)
8. [API Integration](#api-integration)
9. [Routing Strategy](#routing-strategy)
10. [Testing Strategy](#testing-strategy)
11. [Deployment](#deployment)

---

## Overview

### Project Description

DEC_L Web is a modern classifieds platform featuring an Instagram-style interface with a continuous, scrollable feed of visually rich listings. The application provides:

- **Infinite-scroll feed** - Card-based post layout with seamless browsing
- **User authentication** - OAuth (Google/Microsoft/Facebook) and email/password
- **Post management** - Create, edit, schedule, and manage listings
- **Payment integration** - Tiered pricing for enhanced post visibility
- **Messaging system** - Direct communication between buyers and sellers
- **Admin capabilities** - Post approval and content curation

### Design Principles

1. **Simplistic & Modern** - Clean, Instagram-inspired interface
2. **Mobile-First** - Responsive design for all screen sizes
3. **Performance** - Optimized loading and infinite scroll
4. **Accessibility** - WCAG 2.1 AA compliant
5. **Dark Mode** - Native dark theme support

---

## Technology Stack

### Core Framework

- **SvelteKit 2.5+** - Full-stack framework with server-side rendering
- **Svelte 5** - Reactive UI framework with runes API
- **TypeScript 5.6+** - Type-safe development

### Styling

- **TailwindCSS 3.4+** - Utility-first CSS framework
- **PostCSS** - CSS processing
- **Material Symbols** - Icon library (outlined variant)
- **Plus Jakarta Sans** - Primary font family

### State & Data

- **Svelte Stores** - Client-side state management
- **Axios** - HTTP client for API communication
- **Zod** - Runtime type validation

### Development Tools

- **Vite 6** - Build tool and dev server
- **ESLint** - Code linting
- **Prettier** - Code formatting
- **Svelte Check** - Type checking

---

## Project Structure

```
apps/web/
├── src/
│   ├── lib/
│   │   ├── components/
│   │   │   ├── layout/
│   │   │   │   ├── Header.svelte
│   │   │   │   ├── Sidebar.svelte
│   │   │   │   ├── MobileNav.svelte
│   │   │   │   └── Footer.svelte
│   │   │   ├── feed/
│   │   │   │   ├── PostCard.svelte
│   │   │   │   ├── PostGrid.svelte
│   │   │   │   ├── InfiniteScroll.svelte
│   │   │   │   └── PostSkeleton.svelte
│   │   │   ├── post/
│   │   │   │   ├── PostForm.svelte
│   │   │   │   ├── ImageUpload.svelte
│   │   │   │   ├── CategorySelect.svelte
│   │   │   │   ├── PricingTierSelect.svelte
│   │   │   │   └── PostPreview.svelte
│   │   │   ├── auth/
│   │   │   │   ├── LoginForm.svelte
│   │   │   │   ├── RegisterForm.svelte
│   │   │   │   ├── OAuthButtons.svelte
│   │   │   │   └── PhoneVerification.svelte
│   │   │   ├── profile/
│   │   │   │   ├── ProfileCard.svelte
│   │   │   │   ├── ProfileEdit.svelte
│   │   │   │   └── UserPosts.svelte
│   │   │   ├── messages/
│   │   │   │   ├── MessageList.svelte
│   │   │   │   ├── MessageThread.svelte
│   │   │   │   └── MessageInput.svelte
│   │   │   └── ui/
│   │   │       ├── Button.svelte
│   │   │       ├── Input.svelte
│   │   │       ├── TextArea.svelte
│   │   │       ├── Select.svelte
│   │   │       ├── Modal.svelte
│   │   │       ├── Toast.svelte
│   │   │       ├── Icon.svelte
│   │   │       ├── Card.svelte
│   │   │       ├── Badge.svelte
│   │   │       └── Spinner.svelte
│   │   ├── stores/
│   │   │   ├── auth.ts              # Authentication state
│   │   │   ├── posts.ts             # Posts cache and feed state
│   │   │   ├── user.ts              # Current user profile
│   │   │   ├── theme.ts             # Dark/light mode
│   │   │   ├── toast.ts             # Toast notifications
│   │   │   └── modal.ts             # Modal state management
│   │   ├── services/
│   │   │   ├── api.ts               # Axios instance & interceptors
│   │   │   ├── auth.service.ts      # Authentication API calls
│   │   │   ├── post.service.ts      # Post CRUD operations
│   │   │   ├── user.service.ts      # User profile operations
│   │   │   ├── category.service.ts  # Category management
│   │   │   ├── payment.service.ts   # Payment operations
│   │   │   ├── upload.service.ts    # Image upload handling
│   │   │   └── message.service.ts   # Messaging operations
│   │   ├── types/
│   │   │   ├── api.types.ts         # API response types
│   │   │   ├── post.types.ts        # Post-related types
│   │   │   ├── user.types.ts        # User-related types
│   │   │   ├── auth.types.ts        # Auth-related types
│   │   │   └── index.ts             # Type exports
│   │   └── utils/
│   │       ├── format.ts            # Date, currency, text formatting
│   │       ├── validation.ts        # Form validation helpers
│   │       ├── storage.ts           # LocalStorage wrapper
│   │       ├── constants.ts         # App constants
│   │       └── helpers.ts           # General utility functions
│   ├── routes/
│   │   ├── +layout.svelte           # Root layout with nav
│   │   ├── +layout.ts               # Layout data loading
│   │   ├── +page.svelte             # Home/Feed page
│   │   ├── +page.ts                 # Feed data loading
│   │   ├── auth/
│   │   │   ├── login/+page.svelte
│   │   │   ├── register/+page.svelte
│   │   │   ├── callback/+page.ts    # OAuth callback handler
│   │   │   └── logout/+page.ts      # Logout handler
│   │   ├── posts/
│   │   │   ├── [id]/+page.svelte    # View post detail
│   │   │   ├── [id]/+page.ts        # Load post data
│   │   │   ├── create/+page.svelte  # Create new post
│   │   │   ├── edit/[id]/+page.svelte # Edit post
│   │   │   ├── edit/[id]/+page.ts   # Load post for editing
│   │   │   └── my-posts/+page.svelte # User's posts
│   │   ├── profile/
│   │   │   ├── +page.svelte         # View profile
│   │   │   ├── edit/+page.svelte    # Edit profile
│   │   │   └── [username]/+page.svelte # Public profile view
│   │   ├── messages/
│   │   │   ├── +page.svelte         # Message inbox
│   │   │   └── [threadId]/+page.svelte # Message thread
│   │   ├── payment/
│   │   │   ├── select/+page.svelte  # Select pricing tier
│   │   │   └── confirm/+page.svelte # Payment confirmation
│   │   └── admin/
│   │       ├── +layout.svelte       # Admin layout
│   │       ├── posts/+page.svelte   # Pending posts
│   │       └── categories/+page.svelte # Manage categories
│   ├── app.html                     # HTML template
│   └── app.css                      # Global styles
├── static/
│   ├── favicon.png
│   ├── logo.svg
│   └── robots.txt
├── tests/
│   ├── unit/
│   └── integration/
├── package.json
├── svelte.config.js
├── vite.config.ts
├── tsconfig.json
├── tailwind.config.js
├── postcss.config.js
├── .env.example
├── .eslintrc.json
├── .prettierrc
├── Dockerfile
└── README.md
```

---

## Implementation Phases

### Phase 1: Project Setup & Configuration (Days 1-2)

**Goal:** Initialize project with all dependencies and configurations

**Tasks:**

1. ✅ Create `apps/web` directory structure
2. ✅ Initialize SvelteKit project
3. ✅ Install dependencies (Svelte, TypeScript, TailwindCSS, Axios, Zod)
4. ✅ Configure TailwindCSS with custom theme
5. ✅ Set up ESLint and Prettier
6. ✅ Configure path aliases
7. ✅ Create environment variables template
8. ✅ Set up Font imports (Plus Jakarta Sans, Material Symbols)

**Deliverables:**

- Working dev environment (`npm run dev`)
- Type checking setup
- Styling system configured
- Build pipeline functional

---

### Phase 2: Core Services & Type System (Days 3-4)

**Goal:** Build API integration layer and type definitions

**Tasks:**

1. Create TypeScript interfaces matching API types
2. Implement Axios API client with interceptors
3. Build authentication service (login, register, OAuth, token refresh)
4. Build post service (CRUD operations, feed loading, infinite scroll)
5. Build user service (profile, preferences)
6. Build upload service (image upload handling)
7. Implement error handling and retry logic
8. Add request/response logging (dev mode)

**Deliverables:**

- Typed API client
- All service functions implemented
- Error handling standardized
- Token management (access + refresh)

---

### Phase 3: Reusable UI Components (Days 5-7)

**Goal:** Create component library matching design system

**Tasks:**

1. **Base Components:**

   - Button (variants: primary, secondary, ghost, danger)
   - Input (text, email, password, number)
   - TextArea
   - Select/Dropdown
   - Checkbox & Radio
   - Icon wrapper for Material Symbols

2. **Feedback Components:**

   - Toast notifications
   - Modal dialog
   - Loading spinner
   - Skeleton loaders
   - Error boundary

3. **Layout Components:**
   - Card wrapper
   - Badge
   - Avatar
   - Divider

**Deliverables:**

- 15+ reusable components
- Storybook documentation (optional)
- Consistent styling system
- Accessibility features (ARIA labels, keyboard nav)

---

### Phase 4: Authentication System (Days 8-10)

**Goal:** Complete user authentication flow

**Tasks:**

1. **Login Page:**

   - Email/password form
   - OAuth buttons (Google, Microsoft, Facebook)
   - Remember me checkbox
   - Forgot password link
   - Form validation

2. **Registration Page:**

   - User registration form
   - Phone number verification
   - Password strength indicator
   - Terms acceptance
   - OAuth registration

3. **Auth Store:**

   - User state management
   - Token persistence (localStorage)
   - Auto token refresh
   - Protected route guards

4. **OAuth Integration:**
   - OAuth callback handling
   - Provider-specific flows
   - Error handling

**Deliverables:**

- Functional login/register
- OAuth working for all providers
- Protected routes
- Persistent sessions

---

### Phase 5: Feed Interface (Days 11-14)

**Goal:** Implement main feed with infinite scroll

**Tasks:**

1. **PostCard Component:**

   - Image carousel
   - Post metadata (price, location, category)
   - Like button with counter
   - View counter
   - User avatar and name
   - Action menu (edit, delete, share)

2. **Feed Page:**

   - Infinite scroll implementation
   - Post grid/list layout
   - Filtering by category
   - Search functionality
   - Sort options (newest, price, popular)

3. **Post Detail Page:**

   - Full post view
   - Image gallery
   - Contact seller button
   - Similar posts
   - Share functionality

4. **Feed State Management:**
   - Post caching
   - Optimistic updates
   - Real-time like updates

**Deliverables:**

- Working infinite scroll feed
- Post cards matching mockup design
- Detail view with all features
- Performance optimized (lazy loading images)

---

### Phase 6: Post Management (Days 15-18)

**Goal:** Enable users to create and manage posts

**Tasks:**

1. **Create Post Form:**

   - Multi-step form (details, images, pricing)
   - Category selection
   - Brand/condition selection
   - Price input with currency formatting
   - Location selection
   - Delivery method selection
   - Image upload (multiple files)
   - Image preview and reordering
   - Draft saving
   - Scheduling

2. **Image Upload:**

   - Drag & drop interface
   - Image preview
   - Cropping/resizing
   - Progress indicator
   - Multiple file handling
   - File size validation

3. **Pricing Tier Selection:**

   - Visual tier comparison
   - Peak visibility explanation
   - Payment integration
   - Tier upgrade flow

4. **Edit Post:**

   - Load existing post data
   - Update functionality
   - Version control

5. **My Posts Page:**
   - List user's posts
   - Status indicators (pending, active, expired)
   - Quick actions (edit, delete, renew)
   - Analytics preview

**Deliverables:**

- Complete post creation flow
- Image upload working
- Draft management
- Post editing
- User post dashboard

---

### Phase 7: User Profile (Days 19-21)

**Goal:** Implement user profile and settings

**Tasks:**

1. **Profile View:**

   - User information display
   - User's posts grid
   - Statistics (posts, likes, views)
   - Contact button

2. **Profile Edit:**

   - Update personal information
   - Change password
   - Upload profile picture
   - Notification preferences
   - Privacy settings

3. **Public Profile:**
   - Other users' profiles
   - Contact functionality
   - Trust indicators

**Deliverables:**

- Profile viewing
- Profile editing
- Settings management
- Public profiles

---

### Phase 8: Messaging System (Days 22-24)

**Goal:** Enable buyer-seller communication

**Tasks:**

1. **Message Inbox:**

   - List of conversations
   - Unread indicators
   - Search conversations
   - Archive functionality

2. **Message Thread:**

   - Real-time messaging (consider WebSocket)
   - Message bubbles
   - Image sharing
   - Post context card
   - Typing indicators

3. **Message Input:**
   - Text input
   - Emoji picker
   - Image attachment
   - Send on Enter

**Deliverables:**

- Functional messaging system
- Real-time updates
- Message persistence
- Notifications

---

### Phase 9: Admin Features (Days 25-26)

**Goal:** Admin post approval and management

**Tasks:**

1. **Admin Dashboard:**

   - Pending posts queue
   - Approve/reject actions
   - Category management
   - User management (basic)

2. **Post Moderation:**
   - Review interface
   - Rejection reasons
   - Bulk actions

**Deliverables:**

- Admin panel
- Post moderation
- Category CRUD

---

### Phase 10: Polish & Optimization (Days 27-30)

**Goal:** Refine UX and optimize performance

**Tasks:**

1. **Performance:**

   - Image optimization
   - Code splitting
   - Lazy loading
   - Caching strategy
   - Bundle size optimization

2. **UX Improvements:**

   - Loading states
   - Error states
   - Empty states
   - Smooth transitions
   - Micro-interactions

3. **Accessibility:**

   - Keyboard navigation
   - Screen reader support
   - ARIA labels
   - Focus management
   - Color contrast

4. **Testing:**

   - Unit tests for utilities
   - Component tests
   - Integration tests
   - E2E tests (critical paths)

5. **Documentation:**
   - Component documentation
   - API documentation
   - Deployment guide
   - User guide

**Deliverables:**

- Optimized application
- Full test coverage
- Accessibility compliant
- Complete documentation

---

## Configuration Setup

### 1. SvelteKit Configuration

**File:** `svelte.config.js`

```javascript
import adapter from "@sveltejs/adapter-node";
import { vitePreprocess } from "@sveltejs/vite-plugin-svelte";

/** @type {import('@sveltejs/kit').Config} */
const config = {
  preprocess: vitePreprocess(),
  kit: {
    adapter: adapter({
      out: "build",
      precompress: false,
      envPrefix: "VITE_",
    }),
    alias: {
      $lib: "src/lib",
      $components: "src/lib/components",
      $stores: "src/lib/stores",
      $services: "src/lib/services",
      $utils: "src/lib/utils",
      $types: "src/lib/types",
    },
  },
};

export default config;
```

### 2. TailwindCSS Configuration

**File:** `tailwind.config.js`

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: ["./src/**/*.{html,js,svelte,ts}"],
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        primary: "#13ecec",
        "background-light": "#f6f8f8",
        "background-dark": "#102222",
      },
      fontFamily: {
        display: ['"Plus Jakarta Sans"', "sans-serif"],
      },
      borderRadius: {
        DEFAULT: "0.5rem",
        lg: "1rem",
        xl: "1.5rem",
        full: "9999px",
      },
    },
  },
  plugins: [],
};
```

### 3. Environment Variables

**File:** `.env.example`

```env
# API Configuration
VITE_API_URL=http://localhost:3000/api/v1
VITE_API_TIMEOUT=30000

# OAuth Configuration
VITE_GOOGLE_CLIENT_ID=your-google-client-id
VITE_MICROSOFT_CLIENT_ID=your-microsoft-client-id
VITE_FACEBOOK_APP_ID=your-facebook-app-id

# App Configuration
VITE_APP_NAME=DEC_L
VITE_APP_URL=http://localhost:5173
VITE_MAX_UPLOAD_SIZE=5242880
VITE_POSTS_PER_PAGE=20
```

---

## Component Architecture

### Component Hierarchy

```
App
├── +layout.svelte (Root Layout)
│   ├── Header
│   │   ├── Logo
│   │   ├── SearchBar
│   │   ├── UserMenu
│   │   └── ThemeToggle
│   ├── Sidebar (Desktop)
│   │   ├── Navigation Links
│   │   ├── Category Filter
│   │   └── User Stats
│   ├── MobileNav (Mobile)
│   └── Slot (Page Content)
│       └── Footer
```

### Design System

**Colors:**

- Primary: `#13ecec` (Cyan)
- Background Light: `#f6f8f8`
- Background Dark: `#102222`
- Success: Tailwind `green-500`
- Warning: Tailwind `yellow-500`
- Error: Tailwind `red-500`

**Typography:**

- Font Family: Plus Jakarta Sans
- Headings: 700-800 weight
- Body: 400-500 weight

**Spacing:**

- Base unit: 4px (Tailwind's default)
- Container max-width: 1280px

**Breakpoints:**

- Mobile: < 640px
- Tablet: 640px - 1024px
- Desktop: > 1024px

---

## State Management

### Svelte Stores Architecture

**1. Auth Store (`$lib/stores/auth.ts`)**

```typescript
import { writable } from "svelte/store";
import type { User } from "$types/user.types";

interface AuthState {
  user: User | null;
  token: string | null;
  refreshToken: string | null;
  isAuthenticated: boolean;
  isLoading: boolean;
}

function createAuthStore() {
  const { subscribe, set, update } = writable<AuthState>({
    user: null,
    token: null,
    refreshToken: null,
    isAuthenticated: false,
    isLoading: true,
  });

  return {
    subscribe,
    setUser: (user: User, token: string, refreshToken: string) =>
      update((state) => ({
        ...state,
        user,
        token,
        refreshToken,
        isAuthenticated: true,
        isLoading: false,
      })),
    clearAuth: () =>
      set({
        user: null,
        token: null,
        refreshToken: null,
        isAuthenticated: false,
        isLoading: false,
      }),
    setLoading: (isLoading: boolean) =>
      update((state) => ({ ...state, isLoading })),
  };
}

export const authStore = createAuthStore();
```

**2. Posts Store (`$lib/stores/posts.ts`)**

```typescript
import { writable } from "svelte/store";
import type { Post } from "$types/post.types";

interface PostsState {
  items: Post[];
  page: number;
  hasMore: boolean;
  isLoading: boolean;
  filters: {
    category?: string;
    search?: string;
    sortBy?: "newest" | "price-asc" | "price-desc" | "popular";
  };
}

function createPostsStore() {
  const { subscribe, set, update } = writable<PostsState>({
    items: [],
    page: 1,
    hasMore: true,
    isLoading: false,
    filters: {},
  });

  return {
    subscribe,
    addPosts: (posts: Post[]) =>
      update((state) => ({
        ...state,
        items: [...state.items, ...posts],
        hasMore: posts.length > 0,
      })),
    setFilters: (filters: Partial<PostsState["filters"]>) =>
      update((state) => ({
        ...state,
        filters: { ...state.filters, ...filters },
        items: [],
        page: 1,
      })),
    reset: () =>
      set({
        items: [],
        page: 1,
        hasMore: true,
        isLoading: false,
        filters: {},
      }),
  };
}

export const postsStore = createPostsStore();
```

**3. Theme Store (`$lib/stores/theme.ts`)**

```typescript
import { writable } from "svelte/store";
import { browser } from "$app/environment";

type Theme = "light" | "dark";

const storedTheme = browser ? (localStorage.getItem("theme") as Theme) : null;
const prefersDark = browser
  ? window.matchMedia("(prefers-color-scheme: dark)").matches
  : false;

export const theme = writable<Theme>(
  storedTheme || (prefersDark ? "dark" : "light")
);

theme.subscribe((value) => {
  if (browser) {
    localStorage.setItem("theme", value);
    document.documentElement.classList.toggle("dark", value === "dark");
  }
});

export function toggleTheme() {
  theme.update((current) => (current === "light" ? "dark" : "light"));
}
```

---

## API Integration

### API Client Configuration

**File:** `$lib/services/api.ts`

```typescript
import axios, { type AxiosInstance, type AxiosError } from "axios";
import { authStore } from "$stores/auth";
import { goto } from "$app/navigation";
import { get } from "svelte/store";

const API_URL = import.meta.env.VITE_API_URL || "http://localhost:3000/api/v1";
const API_TIMEOUT = parseInt(import.meta.env.VITE_API_TIMEOUT || "30000");

export const apiClient: AxiosInstance = axios.create({
  baseURL: API_URL,
  timeout: API_TIMEOUT,
  headers: {
    "Content-Type": "application/json",
  },
});

// Request interceptor - add auth token
apiClient.interceptors.request.use(
  (config) => {
    const auth = get(authStore);
    if (auth.token) {
      config.headers.Authorization = `Bearer ${auth.token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// Response interceptor - handle errors and token refresh
apiClient.interceptors.response.use(
  (response) => response,
  async (error: AxiosError) => {
    const originalRequest = error.config;

    // Handle 401 - try to refresh token
    if (error.response?.status === 401 && originalRequest) {
      const auth = get(authStore);
      if (auth.refreshToken) {
        try {
          const { data } = await axios.post(`${API_URL}/auth/refresh`, {
            refreshToken: auth.refreshToken,
          });
          authStore.setUser(auth.user!, data.token, data.refreshToken);
          originalRequest.headers.Authorization = `Bearer ${data.token}`;
          return apiClient(originalRequest);
        } catch (refreshError) {
          authStore.clearAuth();
          goto("/auth/login");
        }
      } else {
        authStore.clearAuth();
        goto("/auth/login");
      }
    }

    return Promise.reject(error);
  }
);

export default apiClient;
```

### Service Layer Example

**File:** `$lib/services/post.service.ts`

```typescript
import apiClient from "./api";
import type { Post, CreatePostDTO, UpdatePostDTO } from "$types/post.types";
import type { PaginatedResponse } from "$types/api.types";

export const postService = {
  // Get feed posts with pagination
  async getFeed(page = 1, limit = 20, filters = {}) {
    const params = new URLSearchParams({
      page: page.toString(),
      limit: limit.toString(),
      ...filters,
    });
    const { data } = await apiClient.get<PaginatedResponse<Post>>(
      `/posts?${params}`
    );
    return data;
  },

  // Get single post
  async getPost(id: string) {
    const { data } = await apiClient.get<{ data: Post }>(`/posts/${id}`);
    return data.data;
  },

  // Create post
  async createPost(postData: CreatePostDTO) {
    const { data } = await apiClient.post<{ data: Post }>("/posts", postData);
    return data.data;
  },

  // Update post
  async updatePost(id: string, postData: UpdatePostDTO) {
    const { data } = await apiClient.put<{ data: Post }>(
      `/posts/${id}`,
      postData
    );
    return data.data;
  },

  // Delete post
  async deletePost(id: string) {
    await apiClient.delete(`/posts/${id}`);
  },

  // Like/unlike post
  async toggleLike(id: string) {
    const { data } = await apiClient.post<{ data: { liked: boolean } }>(
      `/posts/${id}/like`
    );
    return data.data.liked;
  },

  // Upload post images
  async uploadImages(files: File[]) {
    const formData = new FormData();
    files.forEach((file) => formData.append("images", file));
    const { data } = await apiClient.post<{ data: { urls: string[] } }>(
      "/posts/upload",
      formData,
      {
        headers: { "Content-Type": "multipart/form-data" },
      }
    );
    return data.data.urls;
  },
};
```

---

## Routing Strategy

### SvelteKit File-Based Routing

**Protected Routes:**

- `/posts/create` - Requires authentication
- `/posts/edit/[id]` - Requires authentication + ownership
- `/posts/my-posts` - Requires authentication
- `/profile/edit` - Requires authentication
- `/messages` - Requires authentication
- `/admin/*` - Requires authentication + admin role

**Public Routes:**

- `/` - Home/Feed
- `/posts/[id]` - Post detail
- `/auth/login` - Login
- `/auth/register` - Registration
- `/profile/[username]` - Public profile

### Route Guards

**File:** `src/hooks.server.ts`

```typescript
import type { Handle } from "@sveltejs/kit";

export const handle: Handle = async ({ event, resolve }) => {
  // Get token from cookie or header
  const token = event.cookies.get("token");

  if (token) {
    // Verify token and attach user to event.locals
    try {
      // Verify JWT and get user
      event.locals.user = await verifyToken(token);
    } catch {
      event.cookies.delete("token");
    }
  }

  return resolve(event);
};
```

---

## Testing Strategy

### Unit Tests

- **Utilities:** 100% coverage
- **Services:** Mock API responses
- **Stores:** State mutations

### Component Tests

- **UI Components:** Props, events, slots
- **Forms:** Validation, submission
- **Interactive:** User interactions

### Integration Tests

- **User Flows:** Login → Create Post → View Feed
- **API Integration:** Real API calls (test environment)

### E2E Tests

- **Critical Paths:**
  - User registration → Create post → Payment
  - Login → Browse → Like posts
  - Admin approve posts

---

## Deployment

### Build Configuration

```bash
# Production build
npm run build

# Preview production build
npm run preview
```

### Environment Variables (Production)

```env
VITE_API_URL=https://api.decl.ug/api/v1
VITE_GOOGLE_CLIENT_ID=prod-google-client-id
VITE_MICROSOFT_CLIENT_ID=prod-microsoft-client-id
VITE_FACEBOOK_APP_ID=prod-facebook-app-id
VITE_APP_URL=https://decl.ug
```

### Docker Deployment

See [CONTAINERIZATION_GUIDE.md](../CONTAINERIZATION_GUIDE.md) for complete Docker setup.

**Quick Start:**

```bash
cd apps/web
docker build -t dec_l_web .
docker run -p 3000:3000 -e VITE_API_URL=http://api:3000/api/v1 dec_l_web
```

---

## Development Workflow

### Getting Started

```bash
# Install dependencies
cd apps/web
npm install

# Copy environment variables
cp .env.example .env
# Edit .env with your values

# Start dev server
npm run dev

# Open browser
open http://localhost:5173
```

### Development Commands

```bash
# Development
npm run dev              # Start dev server with HMR
npm run dev -- --open    # Start and open browser

# Type Checking
npm run check            # Type check
npm run check:watch      # Watch mode

# Code Quality
npm run lint             # Lint code
npm run format           # Format code

# Building
npm run build            # Production build
npm run preview          # Preview production build
```

### Git Workflow

```bash
# Feature branch
git checkout -b feature/feed-implementation

# Commit changes
git add .
git commit -m "feat(feed): implement infinite scroll"

# Push and create PR
git push origin feature/feed-implementation
```

---

## Success Metrics

### Performance Targets

- **First Contentful Paint:** < 1.5s
- **Time to Interactive:** < 3s
- **Lighthouse Score:** > 90
- **Bundle Size:** < 200KB (gzipped)

### User Experience

- **Mobile Responsive:** 100%
- **Accessibility Score:** > 95
- **Browser Support:** Chrome, Firefox, Safari, Edge (last 2 versions)

### Code Quality

- **Test Coverage:** > 80%
- **TypeScript Strict Mode:** Enabled
- **ESLint:** No errors
- **Bundle Analysis:** No duplicate dependencies

---

## Next Steps

1. ✅ Review and approve this plan
2. ⏳ Set up development environment
3. ⏳ Initialize SvelteKit project
4. ⏳ Begin Phase 1 implementation
5. ⏳ Weekly progress reviews

---

## Resources

### Documentation

- [SvelteKit Docs](https://kit.svelte.dev/docs)
- [Svelte Docs](https://svelte.dev/docs)
- [TailwindCSS Docs](https://tailwindcss.com/docs)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)

### Design References

- [Mockups](../specification/final/mock-ups/)
- [Final Draft Spec](../specification/final/final-draft.md)
- [API Documentation](../../apps/api/README.md)

### Tools

- [Svelte DevTools](https://github.com/sveltejs/svelte-devtools)
- [Vite DevTools](https://github.com/webfansplz/vite-plugin-vue-devtools)
- [Axios DevTools](https://github.com/axios/axios-devtools)

---

**Document Version:** 1.0  
**Last Updated:** December 16, 2025  
**Author:** DEC_L Development Team  
**Status:** Ready for Implementation
